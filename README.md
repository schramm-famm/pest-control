# Pest-control
ðŸ“¬ Service for handling notification preferences

## API Documentation
The following APIs are protected by `heimdall`, so requests must have the
`Authorization` header set to the value `Bearer <token>`, where `<token>` is the
token generated by `heimdall`. `heimdall` would then forward the request with an
added `user_id` value that would be taken from the token.

### POST api/prefs
Creates a new set of preferences for a user.

#### Request body format
```
{
    "global": {
        "invitation": boolean (default: true),
        "text_entered": boolean (default: true),
        "text_modified": boolean (default: true),
        "tag": boolean (default: true),
        "role": boolean (default: true),
    },
    "conversation": [
        {
            "conversation_id": string (default: ""),
            "text_entered": boolean (default: true),
            "text_modified": boolean (default: true),
            "tag": boolean (default: true),
            "role": boolean (default: true),
        }
    ]
}
```

All fields are optional. By default (i.e. if the request body is `{}`), all
`global` fields are `true` and there are no conversation notification
preferences.

### GET api/prefs
Retrieves preferences based on query.

#### Query parameters
* `conversation_id`: ID of the conversation (string, optional)

### PUT api/prefs
Replaces the preferences of a user or creates one if one does not already exist.

#### Request body format
```
{
    "global": {
        "invitation": boolean (default: true),
        "text_entered": boolean (default: true),
        "text_modified": boolean (default: true),
        "tag": boolean (default: true),
        "role": boolean (default: true),
    },
    "conversation": [
        {
            "conversation_id": string (default: ""),
            "text_entered": boolean (default: true),
            "text_modified": boolean (default: true),
            "tag": boolean (default: true),
            "role": boolean (default: true),
        }
    ]
}
```

All fields are optional. By default (i.e. if the request body is `{}`), all
`global` fields are `true` and there are no conversation notification
preferences.

### DELETE api/prefs
Deletes preferences based on query. Deletes all of user's preferences if the
`conversation_id` parameter is not set.

#### Query parameters
* `conversation_id`: ID of the conversation (string, optional)
